---
title: "Coupling Groundwater Vulnerability to Contamination and Extreme Precipitation Events Using Active and Passive Remote Sensing Data Products"
author: "Andrew Murray"
date: 'February 17 2020'
output:
  xaringan::moon_reader:
    css: ["default", "my_styles.css"]
    includes:
      after_body: "afterInit.html"
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightLines: true
      highlightStyle: github
      countIncrementalSlides: false
    seal: false
---

class: inverse, center, middle
background-image: url('HurricaneSpace.png')
background-size: cover

# Coupling Groundwater Vulnerability to Contamination and Extreme Precipitation Events Using Active and Passive Remote Sensing Data Products

### Dissertation Proposal

.large[<br>Andrew Murray | University of North Carolina - Chapel Hill | February 17, 2020]

---
exclude: true

```{r setup, echo=FALSE}
knitr::opts_chunk$set(fig.retina = 3, warning = FALSE, message = FALSE, eval = TRUE)


```

```{r, load_refs, include=FALSE, cache=FALSE}
library(RefManageR)
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "alphabetic",
           style = "markdown",
           hyperlink = FALSE,
           dashed = FALSE)
myBib <- ReadBib("./mybib.bib", check = FALSE)
```
---
<video width="100%" height="100%" controls id="my_video">
    <source src="/mp4/florenceSmall.mp4" type="video/mp4" preload>
</video>

???
- Cyclones can have devastating impacts in various ways
  - Wind
  - Water
  - Homelessness
  - Food Security
  - Sickness

---

## .center[Tropical Cyclones in the United States since 2015]

.pull-left[
```{r table, echo=FALSE, eval=TRUE}
library(plotly)
library(dplyr)
library(here)
library(kableExtra)
library(lubridate)
storms <- read.csv(here::here("static/data/statsByStorm.csv"))%>%
  mutate(Form = mdy(Form), Lf = mdy(Lf), Dis=mdy(Dis))

strmSel <- storms%>%
  select(Name,Lf,MaxCat)
#knitr::kable(strmSel,'html')
library(htmlTable)
strmSel2 <- cbind(strmSel[1:10, ],strmSel[11:20, ])
colnames(strmSel2) <- c("Name","Landfall","Max Cat","Name","Landfall","Max Cat")
kable(strmSel2)%>%
  kable_styling(font_size = 17)
```
]

.pull-right[
![Maximum precipitation greater than 100 mm experienced during a single tropical cyclone event since the start of the 2015 tropical cyclone season.](max_ppt.png)
Maximum precipitation greater than 100 mm experienced during a single tropical cyclone event since the start of the 2015 tropical cyclone season.

]

???
- Notice that landfalls range from May to late October

- Here we only consider the maximum, so what this map is not showing is the recurrence of impacts (How many times places were hit)

---
## .center[Cyclone Precipitation a Function of Wind speed?]

.pull-left[
####<br> - There is no correlation between storm wind speed and either rainfall distribution or intensity

####<br> - Try to predict **max** rainfall from wind speed at landfall: $p = .25$ / $r^{2}=.019$

####<br> - Try to predict **mean** rainfall from wind speed at landfall: $p=.06$ / $r^{2}=.065$

So why do we obsess over storm category when the real danger lies in the water?

]

.pull-right[
```{r stormPts,echo=FALSE, message=FALSE,warning=FALSE, fig.cap="Wind speed at landfall plotted against maximum total rainfall experienced at a single point per cyclone event and colored by average mean precipitation experienced over the impacted land area ", out.height = '350px'}

# Set up Fonts for Plots
# Axis font
xaxisFont <- list(
  family = "Arial, sans-serif",
  size = 18,
  color = "black"
)

yaxisFont <- list(
  family = "Arial, sans-serif",
  size = 18,
  color = "black"
)

labelFont <- list(
  family = "Arial, sans-serif",
  size = 18,
  color = "black"
)



# Color palette
pal <- colorRampPalette(c("green","yellow","orange","red", "purple"))


## Plot of wind speed at landfall vs. Max ppt amount
storms%>%
  plot_ly()%>%
  add_markers(x=~LfWsKts, y=~maxPpt, 
              marker = list(line = list(color = 'rgb(0, 0, 0)',
                                        width = 2)),color =~meanPpt, colors = pal(50) , size=20, hoverinfo = "text",
              text = ~paste("Storm: ", Name,"<br>",
                            "Landfall: ",Lf,"<br>",
                            "Max ppt: ",round(maxPpt,1)," mm","<br>",
                            "Mean ppt: ", round(meanPpt,1)," mm","<br>",
                            "Area Receiving Rain: ",rainArea, "km<sup>2"))%>%
  colorbar(title = "Mean ppt [mm]")%>%
  layout(
    xaxis = list(
      title = "Wind speed at Landfall [Kts]", titlefont = labelFont,
      showticklabels = TRUE,
      tickangle = 0,
      tickfont = xaxisFont,
      zeroline = TRUE,
      showline = TRUE,
      mirror = "ticks",
      gridcolor = toRGB("gray50"),
      gridwidth = 1,
      zerolinecolor = toRGB("black"),
      zerolinewidth = 1,
      linecolor = toRGB("black"),
      linewidth = 1),
    title = "Storm Wind Intensity vs Precipitation",
    yaxis = list(title = "Max ppt at Single Point [mm] ", titlefont = labelFont,
                 showticklabels = TRUE,
                 tickangle = 0,
                 tickfont = yaxisFont,
                 zeroline = TRUE,
                 showline = TRUE,
                 mirror = "ticks",
                 gridcolor = toRGB("gray50"),
                 gridwidth = 1,
                 zerolinecolor = toRGB("black"),
                 zerolinewidth = 1,
                 linecolor = toRGB("black"),
                 linewidth = 1),
    showlegend=T,
    legend = list(x = 100, y = 1.5))
```
]

???
Notice the relationships here

- Michael -> Bottom right, high wind, fast moving, low precipitation

- Harvey -> top right, slow moving, high wind, high precipitation

- Imelda, top left, low wind, high precip

---
###.center["Waterborne disease outbreaks in the United States between 1948 and 1998 were **immediately preceded** by precipitation .red[events above the 80th percentile], with a two-month lag in groundwater"]
.right[-Curriero et al., 2001 ]

###.center["Public water systems in large metropolitan areas have substantial portions of their customer base at risk for a waterborne outbreak .red[during a flooding event]"]
.right[-Exum et al., 2018 ]


###.center["There is an increased risk for GI illness among consumers whose drinking water source may be impacted by combined sewer overflows (CSOs) .red[after extreme precipitation.]"]
.right[-Jagai et al., 2015 ]


???
- Connectivity
- What data is available... here it is public water utilities in Harris County, ER visits
- We're really talking about two things here:
  - Public vs private systems
  - groundwater vs surface water

---
.pull-left[### Studies are only as good as their data...

- I estimate that over **60 million people** in the United States obtain their water from privately owned, 'domestic' wells.


### This is important because...

- We still don't fully understand where all of these wells are
  - Public Utilities don't disclose service areas
  - Even if they did, there are over 150,000<br><br>
- Private Wells are not regulated under the Safe Drinking Water Act
  - Very few testing requirements
  - Contamination sources are often unknown
]

.pull-right[
![](well.png)
]

???
So we know that increased rainfall is linked to increased risk of getting sick from water
But what do we not know?

- Studies in the past have been restricted in their data

- Jill Stewart, Andrew George

---

.center[

```{r img1, echo=FALSE, out.width='600px'}
knitr::include_graphics('wellsUS.png')
```

]

???
Notice the distribution of wells across the east coast. Areas at risk of impacts of tropical cyclones are heavily reliant on well water

---
### In fact, five of the top ten states in the U.S. in terms of well numbers are in the southeast

```{r wells, echo=FALSE, out.width='70%'}
library(forcats)
wells <- read.csv(here::here("/static/data/wells.csv"))%>%
  mutate(Wells = as.numeric(gsub(",","",as.character(Wells))))%>%
  arrange(desc(Wells))
wells <- wells[1:51,]
wells%>%
  plot_ly(x=~Wells, y=~fct_reorder(State, Wells, .desc=FALSE))%>%
  add_bars(orientation = 'h')%>%
  layout(xaxis = list(title = "Total Private Wells"),
         yaxis = list(title = "State"),
         title = "Wells by State")
```



---
```{r pptWellsBar,echo=FALSE,eval=TRUE, fig.cap="Estimated private wells in areas impacted by greater than 100mm of precipitation in a single event. Only tropical cyclone events since 2015 considered here.", out.width= "100%"}
df <- read.csv(here::here("static/data/pptWellsBar.csv"))

# Set up Fonts for Plots
# Axis font
xaxisFont <- list(
  family = "Arial, sans-serif",
  size = 16,
  color = "black"
)

yaxisFont <- list(
  family = "Arial, sans-serif",
  size = 12,
  color = "black"
)

labelFont <- list(
  family = "Arial, sans-serif",
  size = 18,
  color = "black"
)

df%>%
  arrange(Name)%>%
  plot_ly(y=~Wells,x=~pptVal, color = ~Name, hoverinfo = "text",
          text = ~paste("State: ",Name,"<br>",
                        format(round(Wells),big.mark=",")," wells were impacted by <br> at least ", pptVal," mm of precipitation"))%>%
  add_bars()%>%
  layout(barmode = 'stack')%>%
  layout(
    xaxis = list(
      title = "Precipitation Received [mm]", titlefont = labelFont,
      showticklabels = TRUE,
      tickangle = 0,
      tickfont = xaxisFont),
    title = "Number of Wells in Areas Defined by <br> Minimum Received Precipitation",
    yaxis = list(title = "Estimated Private Wells",titlefont = labelFont,
                 showticklabels = TRUE,
                 tickangle = 0,
                 tickfont = yaxisFont,
                 tickformat= ","),
    showlegend=T,
    legend = list(x = 100, y = 0.5))
```

???
I calculated precipitation across census block groups

- The earlier map, was essentially laid on top of well estimates at the block group level

---

## Main Points

- ### Extreme Precipitation &#8594; Increase in Waterborne Disease
  - Increased Connectivity means more pathways for contaminants
--

- ### Extreme Precipitation does not necessarily come from Hurricanes
  - But Tropical cyclones, in general, bring extreme precipitation to the southeastern U.S. and we have a lot of data for them
--

- ### 16.5% of the United States gets water from wells
  - Most people do not test their wells regularly
--

- ### If we can estimate where people are at higher risk, maybe we can prevent some of them from getting sick

---
### A Groundwater Vulnerability Index
.left-column[
.big[**D**].med[epth to water table]

.big[**R**].med[echarge]

.big[**A**].med[quifer Media]

.big[**S**].med[oil Media]

.big[**T**].med[opography]

.big[**I**].med[mpact of the Vadose Zone]

.big[**C**].med[onductivity]
]

.right-column[
![](DRASTIC.png)
]

???

The DRASTIC Index was a big project completed by the National groundwater well association and EPA in 1983.

- It has largely gone unchanged since it's creation
- It assumes conditions are static.
- It ignores potentially significant inputs

---
###.center[ The Good, The Bad & The Missing]

.pull-left[
.med[Data that already exists:

- Aquifer Media
- Soil Media
- Vadose Zone
- Topography

Data I need to create:

- Depth to Water Table
- Rate of Recharge
- Hydraulic Conductivity
]]

.pull-right[
.med[Probably Missing from the DRASTIC Index:

- Land Cover / Land Use
  - NLCD
  - Imperviousness
- Advanced Topography
  - Slope
  - Contributing Area
- Spatial Characterization of Vegetation
  - Leaf Area Index (LAI)
- Antecedent Soil Moisture Conditions
]]

---

### <br>Hypothesis:

<br><br>.med[Geophysical landscape features, temporal variability of soil moisture, and land cover are major drivers of groundwater vulnerability to contamination. Extreme precipitation events such as **tropical cyclones overwhelm and impose changes to each of these variables in measurable ways**. Investigating the relationships and the ways in which to measure these impacts will enable future forecasting of vulnerability and better inform disaster response efforts, directly and positively affecting human health.]

---

### Research Goal: Establish an updated index for groundwater vulnerability, which is dynamic and more inclusive of both physical and social factors present in the southeastern United States.

.pull-left[
### Chapter 1:
.med[Linking soil moisture, precipitation and Land cover / Vegetation]
### Chapter 3:
.med[Creation and application of DRASTIC+]
]
.pull-right[
### Chapter 2:
.med[SMAP assisted estimation of hydraulic conductivity, recharge, and water table height]
]
---

.big[Soil Moisture is in the Driver's Seat...]
.pull-left[
- .med[The variables we're discussing here are [mostly] static
  - Topography
  - Land cover
  - Soil and Geology
  - Water Table

These aren't going to change much over the course of a year]

.big[BUT...]

.med[A lot does change, even day to day:
- Saturation of the soil:
  - Hydraulic head / conductivity
  - Recharge
- Vegetation cover (LAI)
]]

.pull-right[
.med[ The common denominator for much of this work is soil moisture:

Soil Moisture, along with other common data sources can be used to calculate:
- Recharge (Rushton et al., 2006)
- Hydraulic conductivity (Vereecken et al., 1990)
]

This has not been attempted at regional scales using SMAP]
---
## Soil Moisture Change from SMAP:
**Hurricane Florence:**

.left-column[.left[
<br>
- ####The Carolinas were saturated prior to landfall of Florence
<br><br>
- ####Note how long drying takes to occur and the variance across the state
]]

.right-column[
<div class="centered">
<video width="800" height="450" controls autoplay>
  <source src="/img/Florence.mp4" type="video/mp4">
</video>
</div>
]

---
##Patterns from SMAP are Evident
![](florence.png)

---
## Incorporating Leaf Area Index

.med[Looking at Hurricane Florence we can see there is something to be said for the relationship between land cover and drying rates:]

```{r import, echo=FALSE,message=FALSE, results = 'hide'}
library(sf)

sf <- st_read(here::here("static/data/Florence.shp"))%>%
  mutate(NLCD = ifelse(Lands == 11,NA,
                       ifelse(Lands == 21, "Developed - Open",
                              ifelse(Lands == 22, "Developed - Low",
                                     ifelse(Lands == 23, "Developed - Med",
                                            ifelse(Lands == 24, "Developed - High",
                                                   ifelse(Lands == 31, "Barren Land",
                                                          ifelse(Lands == 41, "Deciduos Forest",
                                                                 ifelse(Lands == 42, " Evergreen Forest",
                                                                        ifelse(Lands == 43, "Mixed Forest",
                                                                               ifelse(Lands == 51, " Dwarf Scrub",
                                                                                      ifelse(Lands == 52, "Shrub",
                                                                                             ifelse(Lands == 71, "Grassland",
                                                                                                    ifelse(Lands == 72, "Sedge",
                                                                                                           ifelse(Lands == 73, "Lichens",
                                                                                                                  ifelse(Lands == 74, "Moss",
                                                                                                                         ifelse(Lands == 81, "Pasture",
                                                                                                                                ifelse(Lands == 82, "Crops",
                                                                                                                                       ifelse(Lands == 90, "Woody Wetlands",
                                                                                                                                              ifelse(Lands == 95, "Emergent Wetlands",NA)))))))))
                                                                                      )))))))))))
```


```{r boxPlot, echo=FALSE,message=FALSE, out.width='100%',out.height='50%'}
sf%>%
plot_ly(x = ~NLCD, y = ~fall/PPT)%>%
  add_boxplot()%>%
  layout(
    xaxis = list(title = "NLCD Category"),
    yaxis = list(title = "Soil Moisture Decrease [m<sup>3</sup>/m<sup>3</sup>] / PPT [mm]", type = "log")
  )
```

.med[There is more to the story...]

---
## Summary:

.big[
- Extreme precipitation leads to waterborne illness
- Improvement on a dated vulnerability index is needed
- Substantial data is available for the establishment of relationships between landscape and extreme precipitation
  - I have shown here that relationships exist
- The success of this research may help in response efforts to extreme precipitation events and benefit public health
- I am capable of conducting this research
]
---

## Next Steps:

.big[On to Chapter 1:]

.med[
- I have shown preliminary analyses for Hurricane Florence.
  - These will need to be done for the other 19 cyclones
- Generation of variables for statistical testing:
  - Leaf Area Index
  - Topographical variables
      - Slope
      - Contributing Area
      - Aspect
  - Imperviousness
  - Various drying rates (Sensitivity Analysis for optimal drying times)
]
---

.center[ 
## References]

Caldwell, Martyn M, and James H Richards. 1989. “Hydraulic Lift: Water Efflux from Upper Roots Improves Effectiveness of Water Uptake by Deep Roots.” Oecologia 79 (1): 1–5.

Exum, Natalie G., et al. "Extreme precipitation, public health emergencies, and safe drinking water in the USA." Current environmental health reports 5.2 (2018): 305-315.

Jagai, Jyotsna S., et al. "Extreme precipitation and emergency room visits for gastrointestinal illness in areas with and without combined sewer systems: an analysis of Massachusetts data, 2003–2007." Environmental health perspectives 123.9 (2015): 873-879.

Rushton, KR, VHM Eilers, and RC Carter. 2006. “Improved Soil Moisture Balance Methodology for Recharge Estimation.” Journal of Hydrology 318 (1-4): 379–99.

Vereecken, H, J Maes, and J Feyen. 1990. “Estimating Unsaturated Hydraulic Conductivity from Easily Measured Soil Properties.” Soil Science 149 (1): 1–12.